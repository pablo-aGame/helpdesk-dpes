<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Listado — HelpDesk DPES</title>
<link rel="stylesheet" href="styles.css">
</head>
<body>
<header class="header">
  <div>
    <div class="brand">HelpDesk DPES</div>
    <div class="subtitle">Portal de atención técnica – Dirección de Prestaciones Económicas y Sociales</div>
  </div>
  <nav>
    <a class="btn ghost" href="registro.html">Registrarse</a>
  </nav>
</header>
<main class="container">

<div class="card">
  <h2>Listado de tickets</h2>
  <p class="muted">Tus solicitudes registradas (simulación)</p>
  <div style="margin-top:12px" id="ticketsList"></div>
  <div style="margin-top:16px"><a class="btn" href="ticket.html">Levantar nuevo ticket</a> <a class="btn ghost" href="menu.html">Volver al menú</a></div>
</div>
<script>
// Render tickets from localStorage, include two defaults if none exist
document.addEventListener('DOMContentLoaded', function(){
  let arr = JSON.parse(localStorage.getItem('dpes_tickets') || '[]');
  if(arr.length===0){
    arr = [
      {id:'T1PRINT', area:'Impresión', prio:'Normal', desc:'Falla en impresora', loc:'Piso 2 - Oficina 204', date:'12/10/2025', status:'Cerrado', history:[{time:'12/10/2025',text:'Ticket creado'}]},
      {id:'T2OFFICE', area:'Soporte Técnico', prio:'Normal', desc:'Requiere instalación de Office', loc:'Piso 3 - Oficina 305', date:'18/10/2025', status:'Abierto', history:[{time:'18/10/2025',text:'Ticket creado'}]}];
    localStorage.setItem('dpes_tickets', JSON.stringify(arr));
  }
  const container = document.getElementById('ticketsList');
  container.innerHTML = arr.slice().reverse().map(t=>`<div class="ticket"><div><div style="font-weight:700">${t.desc}</div><div class="muted">Área: ${t.area} · Creado: ${t.date}</div></div><div><div class="chip ${t.status==='Abierto'?'open':'closed'}">${t.status}</div><div style="margin-top:8px"><a class="btn" href="detalle.html?id=${t.id}">Ver detalle</a></div></div></div>`).join('');
});
</script>

</main>

</body>
</html>